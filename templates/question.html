{% extends "layout.html" %} {% block content %}

<h1>DUNNO LAND</h1>
<h2>
    <a href="{{url_for('new_comment_question', question_id=question['id'], answer_id=answer_id)}}">
        Question:
    </a>
    {{question['title']}} {{question['question_message']}}
</h2>
<p>Question votes:{{question['vote_number']}}</p>
<form action="{{url_for('delete', question_id=question_id)}}" method="POST">
    <button type="submit" name="delete_q" class="btn btn-primary">
        Delete question
    </button>
</form>
<form
    class="mt-3"
    action="{{url_for('edit_question', question_id=question_id) }}"
    ,
    method="POST"
>
    <button type="submit" name="edit" class="btn btn-primary">
        Edit question
    </button>
    <ul>
        {% for tag in tags %}
        <li>{{ tag.name }}</li>
        {% endfor %}
    </ul>
    <ul>
        {% for comment in comments%}
        <li>
            <a
                href="{{ url_for('edit_comment',question_id=question_id, comment_id=comment['id']) }}"
                >ID:</a
            >{{comment["id"]}} {{comment["message"]}}
            edited_count:{{comment["edited_count"]}}
        </li>
        <form
        action="{{url_for('delete_comments', question_id=question_id,comment_id=comment['id'])}}"
        method="POST"
    >
        <button type="submit" name="delete_c" class="btn btn-primary">
            Delete comment
        </button>
        </form>
        {% endfor %}
    </ul>
</form>
<form
    action="{{url_for('vote_question_up', question_id=question_id)}}"
    method="POST"
>
    <button type="submit" name="like">üëç</button>
</form>
<form
    class="mt-3"
    action="{{url_for('vote_question_down', question_id=question_id)}}"
    method="POST"
>
    <button type="submit" name="hate">üëé</button>
</form>
<hr />
<h3 class="mt-3">Answers:</h3>
<ul>
    {% for answer in answers%}
    
    <li>
        <a
            href="{{ url_for('new_comment', question_id=question_id, answer_id=answer_id) }}"
            >ID:</a
        >{% if  not answer['acceptance']%}
        {{answer["id"]}} {{answer['message']}} vote
        number:{{answer["vote_number"]}}
        {% elif answer['acceptance'] %}
        <p>{{answer["id"]}}</p>
        <strong>{{answer['message']}}</strong>
        <p>vote number:{{answer["vote_number"]}}</p>
        {% endif %}
        
        <ul>
            {% for comment in comments_a[answers.index(answer)] %}
            <li>
                <a
                    href="{{ url_for('edit_comment',question_id=question_id, comment_id=comment['id']) }}"
                    >ID:</a
                >{{comment["id"]}} {{comment["message"]}}
                edited_count:{{comment["edited_count"]}}
            </li>
            
        </ul>
    </li>
    <form
        action="{{url_for('delete_comments', question_id=question_id,comment_id=comment['id'])}}"
        method="POST"
    >
        <button type="submit" name="delete_c" class="btn btn-primary">
            Delete comment
        </button>
        </form>
    {% endfor %}
    <form
        action="{{url_for('delete_answer', answer_id=answer['id'], question_id=question_id)}}"
        method="POST"
    >
        <button type="submit" name="delete_a" class="btn btn-primary">
            Delete answer
        </button>
    </form>
    <a
        href="{{url_for('edit_answer', question_id=question_id, answer_id=answer['id'])}}"
        >Edit answer</a
    >
    <form
        action="{{url_for('vote_answer_up', question_id=question_id, answer_id=answer['id'])}}"
        method="POST"
    >
        <button type="submit" name="like">üëç</button>
    </form>
    <form
        action="{{url_for('vote_answer_down', question_id=question_id, answer_id=answer['id'])}}"
        method="POST"
    >
        <button type="submit" name="hate">üëé</button>
    </form>
        {% if question.user_id == user_id  and not answer['acceptance']%}
            <form
            action="{{url_for('acceptance_answers', answer_id =answer['id'], user_id=answer['user_id'])}}"
            method="POST"
            >
            <input type="hidden" name="question_id" value="{{ question_id }}">
            <button type="submit" name="acceptance">Validate answer</button>
            </form>
            {% elif question['user_id'] == user_id  and answer['acceptance']%}
                <form
                    action="{{url_for('acceptance_answers', answer_id =answer['id'], user_id=answer['user_id'])}}"
                method="POST"
                >
                <input type="hidden" name="question_id" value="{{ question_id }}">
                <button type="submit" name="acceptance">Unvalidate</button>
                </form>
        {% endif %}
    {%endfor%}
</ul>
<p>
    <a href="{{ url_for('new_answer', question_id=question_id) }}"
        >Post a new answer</a
    >
</p>
<p>
    <a href="{{ url_for('list_q') }}">Back to questions</a>
</p>

{% endblock %}
